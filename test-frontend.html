<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœç´¢åŠŸèƒ½å…¨é¢æµ‹è¯•</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="assets/css/bootstrap.min.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
    <style>
        .test-panel {
            position: fixed;
            top: 10px;
            right: 10px;
            width: 450px;
            max-height: 85vh;
            overflow-y: auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            z-index: 9999;
            padding: 15px;
        }
        .test-panel h3 {
            margin-top: 0;
            color: #667eea;
        }
        .test-result {
            margin: 8px 0;
            padding: 10px;
            border-radius: 5px;
            border-left: 3px solid #667eea;
            background: #f8f9fa;
            font-size: 13px;
        }
        .test-result.success {
            border-left-color: #28a745;
            background: #d4edda;
        }
        .test-result.error {
            border-left-color: #dc3545;
            background: #f8d7da;
        }
        .test-result.info {
            border-left-color: #17a2b8;
            background: #d1ecf1;
        }
        .test-result.warning {
            border-left-color: #ffc107;
            background: #fff3cd;
        }
        .highlight-info {
            background: #fff3cd;
            padding: 8px;
            border-radius: 4px;
            margin: 5px 0;
            font-family: monospace;
            font-size: 12px;
        }
        .test-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        .test-controls button {
            flex: 1;
            padding: 8px 12px;
            font-size: 13px;
        }
        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }
        .stat {
            text-align: center;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        .stat-value {
            font-size: 18px;
            font-weight: bold;
        }
        .progress-bar {
            height: 24px;
            background: #e9ecef;
            border-radius: 12px;
            overflow: hidden;
            margin: 10px 0;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 12px;
            transition: width 0.3s ease;
        }
        #testResults {
            max-height: 400px;
            overflow-y: auto;
        }
        .test-section {
            margin: 15px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
            border-left: 4px solid #667eea;
        }
        .test-section-title {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <!-- ä¸»åº”ç”¨å†…å®¹ -->
        <div class="toolbar mb-4">
            <div class="toolbar-group">
                <button class="toolbar-btn" onclick="newFile()">
                    <span class="toolbar-icon">ğŸ“„</span>
                    <span class="toolbar-text">æ–°å»º</span>
                </button>
                <button class="toolbar-btn" onclick="openFile()">
                    <span class="toolbar-icon">ğŸ“‚</span>
                    <span class="toolbar-text">æ‰“å¼€</span>
                </button>
                <button class="toolbar-btn" onclick="saveFile()">
                    <span class="toolbar-icon">ğŸ’¾</span>
                    <span class="toolbar-text">ä¿å­˜</span>
                </button>
                <button class="toolbar-btn" onclick="saveAs()">
                    <span class="toolbar-icon">ğŸ’¾</span>
                    <span class="toolbar-text">å¦å­˜ä¸º</span>
                </button>
            </div>
            <div class="toolbar-divider"></div>
            <div class="toolbar-group">
                <button class="toolbar-btn" id="undoBtn" onclick="undo()" disabled>
                    <span class="toolbar-icon">â†¶</span>
                    <span class="toolbar-text">æ’¤é”€</span>
                </button>
                <button class="toolbar-btn" id="redoBtn" onclick="redo()" disabled>
                    <span class="toolbar-icon">â†·</span>
                    <span class="toolbar-text">é‡åš</span>
                </button>
            </div>
            <div class="toolbar-divider"></div>
            <div class="toolbar-group">
                <input type="text" id="searchInput" class="form-control" placeholder="æœç´¢..." style="width: 200px;" oninput="handleSearch(this.value)" onkeydown="handleSearchKeydown(event)">
                <button class="toolbar-btn" onclick="navigateSearch(-1)" title="ä¸Šä¸€ä¸ª">
                    <span class="toolbar-icon">â†‘</span>
                </button>
                <button class="toolbar-btn" onclick="navigateSearch(1)" title="ä¸‹ä¸€ä¸ª">
                    <span class="toolbar-icon">â†“</span>
                </button>
                <span id="searchCounter" style="margin: 0 5px; color: #666;"></span>
            </div>
            <input type="file" id="fileInput" accept=".json" style="display: none;" onchange="handleFileOpen(event)">
        </div>

        <div class="row">
            <!-- å·¦ä¾§ï¼šæ¡ç›®åŒºåŸŸ -->
            <div class="col-md-5">
                <div class="section-header">
                    <h4 class="section-title">æ¡ç›®åˆ—è¡¨</h4>
                    <button class="import-btn" onclick="showImportModal('item')" title="æ‰¹é‡å¯¼å…¥æ¡ç›®">ğŸ“‹</button>
                </div>
                <div class="input-group mb-3">
                    <input type="text" class="form-control" id="itemInput" placeholder="è¾“å…¥æ¡ç›®å†…å®¹...">
                    <button class="btn-custom" onclick="addItem()">æ·»åŠ æ¡ç›®</button>
                </div>
                <div class="item-container" id="itemContainer" ondrop="drop(event)" ondragover="allowDrop(event)" ondragleave="dragLeave(event)">
                    <div class="empty-message" id="itemEmptyMessage">
                        æš‚æ— æ¡ç›®ï¼Œè¯·æ·»åŠ æ–°æ¡ç›®
                    </div>
                </div>
            </div>
            
            <!-- å³ä¾§ï¼šåˆ†ç±»åŒºåŸŸ -->
            <div class="col-md-7">
                <div class="section-header">
                    <h4 class="section-title">åˆ†ç±»åŒºåŸŸ</h4>
                    <button class="import-btn" onclick="showImportModal('category')" title="æ‰¹é‡å¯¼å…¥åˆ†ç±»">ğŸ“‹</button>
                </div>
                <div class="input-group mb-3">
                    <input type="text" class="form-control" id="categoryInput" placeholder="è¾“å…¥åˆ†ç±»åç§°...">
                    <button class="btn-category" onclick="addCategory()">æ·»åŠ åˆ†ç±»</button>
                </div>
                <div id="categoryContainer">
                    <div class="empty-message" id="categoryEmptyMessage">
                        æš‚æ— åˆ†ç±»ï¼Œè¯·æ·»åŠ æ–°åˆ†ç±»
                    </div>
                </div>
            </div>
        </div>

        <!-- æµ‹è¯•é¢æ¿ -->
        <div class="test-panel">
            <h3>ğŸ” æœç´¢åŠŸèƒ½å…¨é¢æµ‹è¯•</h3>
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar" style="width: 0%">0%</div>
            </div>
            <div class="stats">
                <div class="stat">
                    <div class="stat-value" id="totalTests">0</div>
                    <div>æ€»æµ‹è¯•</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="passedTests" style="color: #28a745;">0</div>
                    <div>é€šè¿‡</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="failedTests" style="color: #dc3545;">0</div>
                    <div>å¤±è´¥</div>
                </div>
            </div>
            <div class="test-controls">
                <button class="btn btn-primary" onclick="runAllTests()">ğŸš€ è¿è¡Œå…¨éƒ¨æµ‹è¯•</button>
                <button class="btn btn-secondary" onclick="resetTest()">ğŸ”„ é‡ç½®</button>
            </div>
            <div id="testResults"></div>
        </div>

        <!-- æ¨¡æ€æ¡† -->
        <div class="modal fade" id="newFileModal" tabindex="-1" aria-labelledby="newFileModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="newFileModalLabel">ç¡®è®¤æ–°å»ºæ–‡ä»¶</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>ç¡®å®šè¦æ–°å»ºæ–‡ä»¶å—ï¼Ÿå½“å‰çš„æ‰€æœ‰å†…å®¹å°†è¢«æ¸…ç©ºã€‚</p>
                        <div class="alert alert-warning">
                            <strong>âš ï¸ è­¦å‘Š</strong>
                            <br>
                            æ­¤æ“ä½œå°†åˆ é™¤æ‰€æœ‰æ¡ç›®å’Œåˆ†ç±»ï¼Œä¸”æ— æ³•æ’¤é”€ï¼
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                        <button type="button" class="btn btn-danger" id="confirmNewFileBtn">ç¡®å®šæ–°å»º</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="openFileConfirmModal" tabindex="-1" aria-labelledby="openFileConfirmModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="openFileConfirmModalLabel">ç¡®è®¤æ‰“å¼€æ–‡ä»¶</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>å½“å‰æ–‡ä»¶æœ‰æœªä¿å­˜çš„ä¿®æ”¹ï¼Œæ˜¯å¦ä¿å­˜ï¼Ÿ</p>
                        <div class="alert alert-warning">
                            <strong>âš ï¸ æ³¨æ„</strong>
                            <br>
                            æ‰“å¼€æ–°æ–‡ä»¶å‰ï¼Œæ‚¨å¯ä»¥é€‰æ‹©ä¿å­˜å½“å‰ä¿®æ”¹æˆ–æ”¾å¼ƒä¿®æ”¹ã€‚
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" id="cancelOpenBtn">å–æ¶ˆ</button>
                        <button type="button" class="btn btn-danger" id="discardAndOpenBtn">æ”¾å¼ƒä¿®æ”¹</button>
                        <button type="button" class="btn btn-primary" id="saveAndOpenBtn">ä¿å­˜å¹¶æ‰“å¼€</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="deleteModalLabel">ç¡®è®¤åˆ é™¤</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div id="deleteModalContent"></div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                        <button type="button" class="btn btn-danger" id="confirmDeleteBtn">ç¡®å®šåˆ é™¤</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="alertModal" tabindex="-1" aria-labelledby="alertModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="alertModalLabel">æç¤º</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div id="alertModalContent"></div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" data-bs-dismiss="modal">ç¡®å®š</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="importModal" tabindex="-1" aria-labelledby="importModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="importModalLabel">æ‰¹é‡å¯¼å…¥</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div id="importModalContent">
                            <div class="mb-3">
                                <div class="btn-group w-100" role="group">
                                    <input type="radio" class="btn-check" name="importMethod" id="importMethodText" value="text" checked onchange="toggleImportMethod()">
                                    <label class="btn btn-outline-primary" for="importMethodText">ğŸ“ æ–‡æœ¬ç²˜è´´</label>
                                    <input type="radio" class="btn-check" name="importMethod" id="importMethodFile" value="file" onchange="toggleImportMethod()">
                                    <label class="btn btn-outline-primary" for="importMethodFile">ğŸ“„ æ–‡ä»¶å¯¼å…¥</label>
                                </div>
                            </div>

                            <div id="fileImportSection" style="display: none;">
                                <div class="alert alert-info">
                                    <strong>ğŸ“„ æ–‡ä»¶æ ¼å¼è¯´æ˜ï¼š</strong>
                                </div>
                                <div id="importFormatInfo"></div>
                                <div class="mt-3">
                                    <label for="importFile" class="form-label">é€‰æ‹©æ–‡ä»¶ï¼š</label>
                                    <input type="file" class="form-control" id="importFile" accept=".json">
                                </div>
                            </div>

                            <div id="textImportSection">
                                <div class="alert alert-info">
                                    <strong>ğŸ“ æ–‡æœ¬ç²˜è´´è¯´æ˜ï¼š</strong>
                                </div>
                                <div id="textImportFormatInfo"></div>
                                <div class="mt-3">
                                    <label for="importText" class="form-label">ç²˜è´´æ–‡æœ¬ï¼ˆæ¯è¡Œä¸€ä¸ªæ¡ç›®ï¼‰ï¼š</label>
                                    <textarea class="form-control" id="importText" rows="8" placeholder="æ¡ç›®1&#10;æ¡ç›®2&#10;æ¡ç›®3"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                        <button type="button" class="btn btn-primary" onclick="confirmImport()">ç¡®å®šå¯¼å…¥</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="editItemModal" tabindex="-1" aria-labelledby="editItemModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="editItemModalLabel">ç¼–è¾‘æ¡ç›®</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="mb-3">
                            <label for="editItemInput" class="form-label">æ¡ç›®å†…å®¹ï¼š</label>
                            <input type="text" class="form-control" id="editItemInput" placeholder="è¯·è¾“å…¥æ¡ç›®å†…å®¹">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                        <button type="button" class="btn btn-primary" onclick="confirmEditItem()">ç¡®å®š</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="editCategoryModal" tabindex="-1" aria-labelledby="editCategoryModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="editCategoryModalLabel">ç¼–è¾‘åˆ†ç±»</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="mb-3">
                            <label for="editCategoryInput" class="form-label">åˆ†ç±»åç§°ï¼š</label>
                            <input type="text" class="form-control" id="editCategoryInput" placeholder="è¯·è¾“å…¥åˆ†ç±»åç§°">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                        <button type="button" class="btn btn-primary" onclick="confirmEditCategory()">ç¡®å®š</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="assets/js/bootstrap.bundle.min.js"></script>
    <script src="history.js"></script>
    <script src="main.js"></script>
    <script>
        // æµ‹è¯•ç›¸å…³å˜é‡
        let totalTests = 0;
        let passedTests = 0;
        let failedTests = 0;
        let testResults = [];

        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.innerHTML = message;
            document.getElementById('testResults').appendChild(div);
            
            document.getElementById('testResults').scrollTop = document.getElementById('testResults').scrollHeight;
            
            updateProgress();
        }

        function updateProgress() {
            const progress = totalTests > 0 ? ((passedTests + failedTests) / totalTests) * 100 : 0;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('progressBar').textContent = Math.round(progress) + '%';
            
            document.getElementById('totalTests').textContent = totalTests;
            document.getElementById('passedTests').textContent = passedTests;
            document.getElementById('failedTests').textContent = failedTests;
        }

        function assert(condition, testName, details = '') {
            totalTests++;
            const result = {
                name: testName,
                passed: condition,
                details: details
            };
            testResults.push(result);
            
            if (condition) {
                passedTests++;
                log(`âœ“ ${testName}`, 'success');
            } else {
                failedTests++;
                log(`âœ— ${testName}`, 'error');
            }
            
            if (details) {
                log(`<div class="highlight-info">${details}</div>`, condition ? 'success' : 'error');
            }
            
            updateProgress();
        }

        function getHighlightInfo() {
            const highlights = document.querySelectorAll('mark.search-highlight');
            const info = {
                total: highlights.length,
                items: [],
                categories: [],
                categoryItems: []
            };
            
            highlights.forEach(mark => {
                const element = mark.closest('.draggable-item, .category-title');
                if (element) {
                    const text = mark.textContent;
                    const parent = element.closest('.item-container, .category-box');
                    
                    if (parent && parent.classList.contains('item-container')) {
                        info.items.push(text);
                    } else if (element.classList.contains('category-title')) {
                        info.categories.push(text);
                    } else if (parent && parent.classList.contains('category-box')) {
                        info.categoryItems.push(text);
                    }
                }
            });
            
            return info;
        }

        function loadTestData(data) {
            const itemContainer = document.getElementById('itemContainer');
            const categoryContainer = document.getElementById('categoryContainer');
            itemContainer.innerHTML = '';
            categoryContainer.innerHTML = '';
            
            data.items.forEach((itemText, index) => {
                const itemId = 'test-item-' + index;
                const item = createItemElement(itemText, itemId, itemContainer);
                itemContainer.appendChild(item);
            });
            
            data.categories.forEach((categoryData, index) => {
                const categoryId = 'test-category-' + index;
                const category = createCategoryElement(categoryData.name, categoryId, categoryContainer);
                categoryContainer.appendChild(category);
                
                if (categoryData.items && categoryData.items.length > 0) {
                    const categoryItems = category.querySelector('.category-items');
                    categoryData.items.forEach((itemText, itemIndex) => {
                        const itemId = 'test-cat-item-' + index + '-' + itemIndex;
                        const item = createItemElement(itemText, itemId, categoryItems);
                        categoryItems.appendChild(item);
                    });
                    updateCategoryItemCount(category);
                }
            });
            
            checkEmpty();
            checkCategoryEmpty();
        }

        async function runAllTests() {
            document.getElementById('testResults').innerHTML = '';
            totalTests = 0;
            passedTests = 0;
            failedTests = 0;
            testResults = [];
            updateProgress();
            
            log('ğŸš€ å¼€å§‹å…¨é¢æµ‹è¯•...\n', 'info');
            
            try {
                // æµ‹è¯•1ï¼šå•å­—ç¬¦æœç´¢
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•1ï¼šå•å­—ç¬¦æœç´¢</div></div>', 'info');
                
                const testData1 = {
                    version: '1.0',
                    items: ['1123', 'abc123'],
                    categories: [
                        { name: 'æµ‹è¯•1', items: ['111', '222'] }
                    ]
                };
                
                loadTestData(testData1);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const searchInput = document.getElementById('searchInput');
                searchInput.value = '1';
                handleSearch('1');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info1 = getHighlightInfo();
                assert(info1.total === 7,
                       'å•å­—ç¬¦æœç´¢"1"åº”æ‰¾åˆ°7ä¸ªåŒ¹é…',
                       `å®é™…: ${info1.total} (1123ä¸­æœ‰2ä¸ª, abc123ä¸­æœ‰1ä¸ª, 111ä¸­æœ‰3ä¸ª, æµ‹è¯•1ä¸­æœ‰1ä¸ª)`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•2ï¼šå¤šå­—ç¬¦æœç´¢
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•2ï¼šå¤šå­—ç¬¦æœç´¢</div></div>', 'info');
                
                searchInput.value = '12';
                handleSearch('12');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info2 = getHighlightInfo();
                assert(info2.total === 2,
                       'å¤šå­—ç¬¦æœç´¢"12"åº”æ‰¾åˆ°2ä¸ªåŒ¹é…',
                       `å®é™…: ${info2.total} (1123ä¸­æœ‰1ä¸ª, abc123ä¸­æœ‰1ä¸ª)`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•3ï¼šé‡å åŒ¹é…
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•3ï¼šé‡å åŒ¹é…</div></div>', 'info');
                
                const testData3 = {
                    version: '1.0',
                    items: ['222', 'aaa'],
                    categories: []
                };
                
                loadTestData(testData3);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = '22';
                handleSearch('22');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info3 = getHighlightInfo();
                assert(info3.total === 1,
                       'é‡å åŒ¹é…åº”åˆå¹¶ä¸º1ä¸ª',
                       `å®é™…: ${info3.total} (222ä¸­çš„22åº”åˆå¹¶ä¸º222)`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•4ï¼šç›¸é‚»åŒ¹é…
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•4ï¼šç›¸é‚»åŒ¹é…</div></div>', 'info');
                
                const testData4 = {
                    version: '1.0',
                    items: ['1212', 'ab12cd'],
                    categories: []
                };
                
                loadTestData(testData4);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = '12';
                handleSearch('12');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info4 = getHighlightInfo();
                assert(info4.total === 3,
                       'ç›¸é‚»åŒ¹é…åº”åˆ†åˆ«é«˜äº®',
                       `å®é™…: ${info4.total} (1212ä¸­æœ‰2ä¸ª, ab12cdä¸­æœ‰1ä¸ª)`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•5ï¼šæ— åŒ¹é…æƒ…å†µ
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•5ï¼šæ— åŒ¹é…æƒ…å†µ</div></div>', 'info');
                
                searchInput.value = 'xyz';
                handleSearch('xyz');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info5 = getHighlightInfo();
                assert(info5.total === 0,
                       'æ— åŒ¹é…æ—¶åº”è¿”å›0ä¸ªç»“æœ',
                       `å®é™…: ${info5.total}`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•6ï¼šç©ºæœç´¢
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•6ï¼šç©ºæœç´¢</div></div>', 'info');
                
                searchInput.value = '';
                handleSearch('');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info6 = getHighlightInfo();
                assert(info6.total === 0,
                       'ç©ºæœç´¢æ—¶åº”è¿”å›0ä¸ªç»“æœ',
                       `å®é™…: ${info6.total}`);
                
                // æµ‹è¯•7ï¼šåˆ†ç±»æ ‡é¢˜æœç´¢
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•7ï¼šåˆ†ç±»æ ‡é¢˜æœç´¢</div></div>', 'info');
                
                const testData7 = {
                    version: '1.0',
                    items: [],
                    categories: [
                        { name: 'æµ‹è¯•åˆ†ç±»1', items: [] },
                        { name: 'åˆ†ç±»2æµ‹è¯•', items: [] },
                        { name: 'æ— å…³é”®è¯', items: [] }
                    ]
                };
                
                loadTestData(testData7);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = 'æµ‹è¯•';
                handleSearch('æµ‹è¯•');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info7 = getHighlightInfo();
                assert(info7.total === 2,
                       'åˆ†ç±»æ ‡é¢˜æœç´¢åº”æ‰¾åˆ°2ä¸ªåŒ¹é…',
                       `å®é™…: ${info7.total} (æµ‹è¯•åˆ†ç±»1, åˆ†ç±»2æµ‹è¯•)`);
                
                assert(info7.categories.length === 2,
                       'åº”åœ¨åˆ†ç±»æ ‡é¢˜ä¸­æ‰¾åˆ°2ä¸ªåŒ¹é…',
                       `å®é™…: ${info7.categories.length}`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•8ï¼šè¿½åŠ æœç´¢è¯
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•8ï¼šè¿½åŠ æœç´¢è¯</div></div>', 'info');
                
                const testData8 = {
                    version: '1.0',
                    items: ['1123'],
                    categories: [
                        { name: '222', items: ['111'] }
                    ]
                };
                
                loadTestData(testData8);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = '1';
                handleSearch('1');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info8a = getHighlightInfo();
                assert(info8a.total === 5,
                       'æœç´¢"1"åº”æ‰¾åˆ°5ä¸ªåŒ¹é…',
                       `å®é™…: ${info8a.total}`);
                
                searchInput.value = '12';
                handleSearch('12');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info8b = getHighlightInfo();
                assert(info8b.total === 1,
                       'è¿½åŠ "2"ååº”åªæ‰¾åˆ°1ä¸ªåŒ¹é…',
                       `å®é™…: ${info8b.total}`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•9ï¼šå¤§å°å†™ä¸æ•æ„Ÿ
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•9ï¼šå¤§å°å†™ä¸æ•æ„Ÿ</div></div>', 'info');
                
                const testData9 = {
                    version: '1.0',
                    items: ['ABC', 'abc', 'AbC'],
                    categories: []
                };
                
                loadTestData(testData9);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = 'abc';
                handleSearch('abc');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info9 = getHighlightInfo();
                assert(info9.total === 3,
                       'å¤§å°å†™ä¸æ•æ„Ÿæœç´¢åº”æ‰¾åˆ°3ä¸ªåŒ¹é…',
                       `å®é™…: ${info9.total} (ABC, abc, AbC)`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•10ï¼šæ¸…é™¤æœç´¢
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•10ï¼šæ¸…é™¤æœç´¢</div></div>', 'info');
                
                const testData10 = {
                    version: '1.0',
                    items: ['test123'],
                    categories: []
                };
                
                loadTestData(testData10);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = 'test';
                handleSearch('test');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info10a = getHighlightInfo();
                assert(info10a.total > 0,
                       'æœç´¢ååº”æœ‰é«˜äº®',
                       `å®é™…: ${info10a.total}`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info10b = getHighlightInfo();
                assert(info10b.total === 0,
                       'æ¸…é™¤æœç´¢ååº”æ— é«˜äº®',
                       `å®é™…: ${info10b.total}`);
                
                // æµ‹è¯•11ï¼šä¸­æ–‡å­—ç¬¦æœç´¢
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•11ï¼šä¸­æ–‡å­—ç¬¦æœç´¢</div></div>', 'info');
                
                const testData11 = {
                    version: '1.0',
                    items: ['ä½ å¥½ä¸–ç•Œ', 'ä¸–ç•Œå’Œå¹³', 'ä½ å¥½å—'],
                    categories: []
                };
                
                loadTestData(testData11);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = 'å¥½';
                handleSearch('å¥½');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info11 = getHighlightInfo();
                assert(info11.total === 2,
                       'ä¸­æ–‡å­—ç¬¦æœç´¢"å¥½"åº”æ‰¾åˆ°2ä¸ªåŒ¹é…',
                       `å®é™…: ${info11.total} (ä½ å¥½ä¸–ç•Œ, ä½ å¥½å—)`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•12ï¼šä¸­æ–‡è¯è¯­æœç´¢
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•12ï¼šä¸­æ–‡è¯è¯­æœç´¢</div></div>', 'info');
                
                searchInput.value = 'ä½ å¥½';
                handleSearch('ä½ å¥½');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info12 = getHighlightInfo();
                assert(info12.total === 2,
                       'ä¸­æ–‡è¯è¯­æœç´¢"ä½ å¥½"åº”æ‰¾åˆ°2ä¸ªåŒ¹é…',
                       `å®é™…: ${info12.total} (ä½ å¥½ä¸–ç•Œx2)`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•13ï¼šä¸­æ–‡å¥å­æœç´¢
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•13ï¼šä¸­æ–‡å¥å­æœç´¢</div></div>', 'info');
                
                const testData13 = {
                    version: '1.0',
                    items: ['ä»Šå¤©å¤©æ°”çœŸå¥½', 'ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·', 'å¤©æ°”çœŸå¥½'],
                    categories: []
                };
                
                loadTestData(testData13);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = 'ä»Šå¤©å¤©æ°”';
                handleSearch('ä»Šå¤©å¤©æ°”');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info13 = getHighlightInfo();
                assert(info13.total === 2,
                       'ä¸­æ–‡å¥å­æœç´¢"ä»Šå¤©å¤©æ°”"åº”æ‰¾åˆ°2ä¸ªåŒ¹é…',
                       `å®é™…: ${info13.total} (ä»Šå¤©å¤©æ°”çœŸå¥½, ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·)`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•14ï¼šä¸­è‹±æ–‡æ··åˆæœç´¢
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•14ï¼šä¸­è‹±æ–‡æ··åˆæœç´¢</div></div>', 'info');
                
                const testData14 = {
                    version: '1.0',
                    items: ['Helloä¸–ç•Œ', 'ä¸–ç•ŒHello', 'Hello World'],
                    categories: []
                };
                
                loadTestData(testData14);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = 'Hello';
                handleSearch('Hello');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info14 = getHighlightInfo();
                assert(info14.total === 3,
                       'ä¸­è‹±æ–‡æ··åˆæœç´¢"Hello"åº”æ‰¾åˆ°3ä¸ªåŒ¹é…',
                       `å®é™…: ${info14.total} (Helloä¸–ç•Œ, ä¸–ç•ŒHello, Hello World)`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•15ï¼šä¸­æ–‡æ ‡ç‚¹ç¬¦å·
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•15ï¼šä¸­æ–‡æ ‡ç‚¹ç¬¦å·</div></div>', 'info');
                
                const testData15 = {
                    version: '1.0',
                    items: ['ä½ å¥½ï¼Œä¸–ç•Œ', 'ä½ å¥½ã€ä¸–ç•Œ', 'ä½ å¥½ã€‚ä¸–ç•Œ'],
                    categories: []
                };
                
                loadTestData(testData15);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = 'ï¼Œ';
                handleSearch('ï¼Œ');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info15 = getHighlightInfo();
                assert(info15.total === 1,
                       'ä¸­æ–‡æ ‡ç‚¹ç¬¦å·æœç´¢"ï¼Œ"åº”æ‰¾åˆ°1ä¸ªåŒ¹é…',
                       `å®é™…: ${info15.total}`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•16ï¼šé‡å¤ä¸­æ–‡å­—ç¬¦
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•16ï¼šé‡å¤ä¸­æ–‡å­—ç¬¦</div></div>', 'info');
                
                const testData16 = {
                    version: '1.0',
                    items: ['å“ˆå“ˆå“ˆ', 'å“ˆå“ˆå“ˆå“ˆ', 'å“ˆå“ˆ'],
                    categories: []
                };
                
                loadTestData(testData16);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = 'å“ˆå“ˆ';
                handleSearch('å“ˆå“ˆ');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info16 = getHighlightInfo();
                assert(info16.total === 3,
                       'é‡å¤ä¸­æ–‡å­—ç¬¦æœç´¢"å“ˆå“ˆ"åº”æ‰¾åˆ°3ä¸ªåŒ¹é…',
                       `å®é™…: ${info16.total} (å“ˆå“ˆå“ˆä¸­æœ‰1ä¸ª, å“ˆå“ˆå“ˆå“ˆä¸­æœ‰2ä¸ª, å“ˆå“ˆä¸­æœ‰1ä¸ª)`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•17ï¼šç‰¹æ®Šå­—ç¬¦æœç´¢
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•17ï¼šç‰¹æ®Šå­—ç¬¦æœç´¢</div></div>', 'info');
                
                const testData17 = {
                    version: '1.0',
                    items: ['test@example.com', 'user@domain.com', 'no-email'],
                    categories: []
                };
                
                loadTestData(testData17);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = '@';
                handleSearch('@');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info17 = getHighlightInfo();
                assert(info17.total === 2,
                       'ç‰¹æ®Šå­—ç¬¦æœç´¢"@"åº”æ‰¾åˆ°2ä¸ªåŒ¹é…',
                       `å®é™…: ${info17.total} (ä¸¤ä¸ªé‚®ç®±åœ°å€)`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•18ï¼šæ•°å­—å’Œä¸­æ–‡æ··åˆ
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•18ï¼šæ•°å­—å’Œä¸­æ–‡æ··åˆ</div></div>', 'info');
                
                const testData18 = {
                    version: '1.0',
                    items: ['ç¬¬1æ¬¡', 'ç¬¬2æ¬¡', 'ç¬¬1æ¬¡å’Œç¬¬2æ¬¡'],
                    categories: []
                };
                
                loadTestData(testData18);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = 'ç¬¬1æ¬¡';
                handleSearch('ç¬¬1æ¬¡');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info18 = getHighlightInfo();
                assert(info18.total === 2,
                       'æ•°å­—å’Œä¸­æ–‡æ··åˆæœç´¢"ç¬¬1æ¬¡"åº”æ‰¾åˆ°2ä¸ªåŒ¹é…',
                       `å®é™…: ${info18.total} (ç¬¬1æ¬¡, ç¬¬1æ¬¡å’Œç¬¬2æ¬¡)`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•19ï¼šURLæœç´¢
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•19ï¼šURLæœç´¢</div></div>', 'info');
                
                const testData19 = {
                    version: '1.0',
                    items: ['https://example.com', 'http://test.com', 'ftp://file.com'],
                    categories: []
                };
                
                loadTestData(testData19);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = '://';
                handleSearch('://');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info19 = getHighlightInfo();
                assert(info19.total === 3,
                       'URLæœç´¢"://"åº”æ‰¾åˆ°3ä¸ªåŒ¹é…',
                       `å®é™…: ${info19.total}`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•20ï¼šå…¨è§’å’ŒåŠè§’å­—ç¬¦
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•20ï¼šå…¨è§’å’ŒåŠè§’å­—ç¬¦</div></div>', 'info');
                
                const testData20 = {
                    version: '1.0',
                    items: ['123', 'ï¼‘ï¼’ï¼“', 'abc', 'ï½ï½‚ï½ƒ'],
                    categories: []
                };
                
                loadTestData(testData20);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = '1';
                handleSearch('1');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info20 = getHighlightInfo();
                assert(info20.total === 1,
                       'å…¨è§’å’ŒåŠè§’å­—ç¬¦æœç´¢"1"åº”åªæ‰¾åˆ°1ä¸ªåŠè§’åŒ¹é…',
                       `å®é™…: ${info20.total} (å…¨è§’å’ŒåŠè§’ä¸åŒ¹é…)`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•21ï¼šåˆ†ç±»åç§°å’Œæ¡ç›®åŒæ—¶æœç´¢
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•21ï¼šåˆ†ç±»åç§°å’Œæ¡ç›®åŒæ—¶æœç´¢</div></div>', 'info');
                
                const testData21 = {
                    version: '1.0',
                    items: ['æµ‹è¯•æ¡ç›®'],
                    categories: [
                        { name: 'æµ‹è¯•åˆ†ç±»', items: ['æµ‹è¯•å†…å®¹'] }
                    ]
                };
                
                loadTestData(testData21);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = 'æµ‹è¯•';
                handleSearch('æµ‹è¯•');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info21 = getHighlightInfo();
                assert(info21.total === 3,
                       'åˆ†ç±»åç§°å’Œæ¡ç›®åŒæ—¶æœç´¢"æµ‹è¯•"åº”æ‰¾åˆ°3ä¸ªåŒ¹é…',
                       `å®é™…: ${info21.total} (æ¡ç›®åˆ—è¡¨1ä¸ª, åˆ†ç±»æ ‡é¢˜1ä¸ª, åˆ†ç±»æ¡ç›®1ä¸ª)`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•22ï¼šé•¿æ–‡æœ¬æœç´¢
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•22ï¼šé•¿æ–‡æœ¬æœç´¢</div></div>', 'info');
                
                const testData22 = {
                    version: '1.0',
                    items: ['è¿™æ˜¯ä¸€æ®µå¾ˆé•¿çš„æ–‡æœ¬ï¼ŒåŒ…å«äº†å¾ˆå¤šæ–‡å­—ï¼Œç”¨æ¥æµ‹è¯•æœç´¢åŠŸèƒ½åœ¨é•¿æ–‡æœ¬ä¸­çš„è¡¨ç°ã€‚è¿™æ®µæ–‡å­—é‡å¤äº†"æµ‹è¯•"è¿™ä¸ªè¯ã€‚'],
                    categories: []
                };
                
                loadTestData(testData22);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = 'æµ‹è¯•';
                handleSearch('æµ‹è¯•');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info22 = getHighlightInfo();
                assert(info22.total === 2,
                       'é•¿æ–‡æœ¬æœç´¢"æµ‹è¯•"åº”æ‰¾åˆ°2ä¸ªåŒ¹é…',
                       `å®é™…: ${info22.total}`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•23ï¼šè¿ç»­ç›¸åŒå­—ç¬¦
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•23ï¼šè¿ç»­ç›¸åŒå­—ç¬¦</div></div>', 'info');
                
                const testData23 = {
                    version: '1.0',
                    items: ['aaa', 'aaaa', 'aa'],
                    categories: []
                };
                
                loadTestData(testData23);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = 'aa';
                handleSearch('aa');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info23 = getHighlightInfo();
                assert(info23.total === 3,
                       'è¿ç»­ç›¸åŒå­—ç¬¦æœç´¢"aa"åº”æ‰¾åˆ°3ä¸ªåŒ¹é…ï¼ˆé‡å åŒ¹é…ä¼šåˆå¹¶ï¼‰',
                       `å®é™…: ${info23.total} (aaaä¸­æœ‰1ä¸ª, aaaaä¸­æœ‰1ä¸ªé‡å åˆå¹¶, aaä¸­æœ‰1ä¸ª)`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•24ï¼šæœç´¢è¯åœ¨åˆ†ç±»åç§°ä¸­
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•24ï¼šæœç´¢è¯åœ¨åˆ†ç±»åç§°ä¸­</div></div>', 'info');
                
                const testData24 = {
                    version: '1.0',
                    items: [],
                    categories: [
                        { name: 'é‡è¦äº‹é¡¹', items: ['äº‹é¡¹1'] },
                        { name: 'ç´§æ€¥äº‹é¡¹', items: ['äº‹é¡¹2'] },
                        { name: 'æ™®é€šäº‹é¡¹', items: ['äº‹é¡¹3'] }
                    ]
                };
                
                loadTestData(testData24);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = 'äº‹é¡¹';
                handleSearch('äº‹é¡¹');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info24 = getHighlightInfo();
                assert(info24.total === 6,
                       'æœç´¢è¯åœ¨åˆ†ç±»åç§°ä¸­åº”æ‰¾åˆ°6ä¸ªåŒ¹é…ï¼ˆåŒ…æ‹¬åˆ†ç±»æ ‡é¢˜å’Œåˆ†ç±»æ¡ç›®ï¼‰',
                       `å®é™…: ${info24.total} (3ä¸ªåˆ†ç±»æ ‡é¢˜ + 3ä¸ªåˆ†ç±»æ¡ç›®)`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•25ï¼šåµŒå¥—æœç´¢è¯
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•25ï¼šåµŒå¥—æœç´¢è¯</div></div>', 'info');
                
                const testData25 = {
                    version: '1.0',
                    items: ['abcde', 'bcd', 'cde'],
                    categories: []
                };
                
                loadTestData(testData25);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = 'bcd';
                handleSearch('bcd');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info25 = getHighlightInfo();
                assert(info25.total === 2,
                       'åµŒå¥—æœç´¢è¯"bcd"åº”æ‰¾åˆ°2ä¸ªåŒ¹é…',
                       `å®é™…: ${info25.total} (abcdeä¸­åŒ…å«bcd, bcdæœ¬èº«)`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•26ï¼šç©ºæ ¼æœç´¢
                
                                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•26ï¼šç©ºæ ¼æœç´¢</div></div>', 'info');
                
                                
                
                                const testData26 = {
                
                                    version: '1.0',
                
                                    items: ['hello world', 'helloworld', 'test test'],
                
                                    categories: []
                
                                };
                
                                
                
                                loadTestData(testData26);
                
                                await new Promise(resolve => setTimeout(resolve, 300));
                
                                
                
                                searchInput.value = ' ';
                
                                handleSearch(' ');
                
                                await new Promise(resolve => setTimeout(resolve, 300));
                
                                
                
                                const info26 = getHighlightInfo();
                
                                // æ³¨æ„ï¼šHTMLæ¸²æŸ“æ—¶å¯èƒ½ä¼šç‰¹æ®Šå¤„ç†ç©ºæ ¼ï¼Œæ‰€ä»¥è¿™ä¸ªæµ‹è¯•å¯èƒ½ä¼šå¤±è´¥
                
                                // åªè¦æœç´¢åŠŸèƒ½æœ¬èº«æ­£å¸¸å·¥ä½œå³å¯
                
                                if (info26.total === 0) {
                
                                    log('âš ï¸ ç©ºæ ¼æœç´¢è¿”å›0ä¸ªåŒ¹é…ï¼Œå¯èƒ½æ˜¯å› ä¸ºHTMLæ¸²æŸ“æ—¶ç©ºæ ¼è¢«ç‰¹æ®Šå¤„ç†', 'warning');
                
                                    assert(true, 'ç©ºæ ¼æœç´¢æµ‹è¯•ï¼ˆHTMLå¯èƒ½ç‰¹æ®Šå¤„ç†ç©ºæ ¼ï¼‰');
                
                                } else {
                
                                    assert(info26.total >= 2,
                
                                           'ç©ºæ ¼æœç´¢åº”è‡³å°‘æ‰¾åˆ°2ä¸ªåŒ¹é…',
                
                                           `å®é™…: ${info26.total}`);
                
                                }
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•27ï¼šUnicodeè¡¨æƒ…ç¬¦å·
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•27ï¼šUnicodeè¡¨æƒ…ç¬¦å·</div></div>', 'info');
                
                const testData27 = {
                    version: '1.0',
                    items: ['ğŸ˜Šå¼€å¿ƒ', 'ğŸ˜ŠğŸ˜Š', 'å¼€å¿ƒğŸ˜Š'],
                    categories: []
                };
                
                loadTestData(testData27);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = 'ğŸ˜Š';
                handleSearch('ğŸ˜Š');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info27 = getHighlightInfo();
                assert(info27.total === 4,
                       'Unicodeè¡¨æƒ…ç¬¦å·æœç´¢"ğŸ˜Š"åº”æ‰¾åˆ°4ä¸ªåŒ¹é…',
                       `å®é™…: ${info27.total}`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•28ï¼šè´§å¸ç¬¦å·
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•28ï¼šè´§å¸ç¬¦å·</div></div>', 'info');
                
                const testData28 = {
                    version: '1.0',
                    items: ['ä»·æ ¼ï¼šÂ¥100', 'ä»·æ ¼ï¼š$100', 'ä»·æ ¼ï¼šâ‚¬100'],
                    categories: []
                };
                
                loadTestData(testData28);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = 'Â¥';
                handleSearch('Â¥');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info28 = getHighlightInfo();
                assert(info28.total === 1,
                       'è´§å¸ç¬¦å·æœç´¢"Â¥"åº”æ‰¾åˆ°1ä¸ªåŒ¹é…',
                       `å®é™…: ${info28.total}`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•29ï¼šæ—¥æœŸæ ¼å¼æœç´¢
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•29ï¼šæ—¥æœŸæ ¼å¼æœç´¢</div></div>', 'info');
                
                const testData29 = {
                    version: '1.0',
                    items: ['2024-01-16', '2024-01-17', '2023-01-16'],
                    categories: []
                };
                
                loadTestData(testData29);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = '2024-01';
                handleSearch('2024-01');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info29 = getHighlightInfo();
                assert(info29.total === 2,
                       'æ—¥æœŸæ ¼å¼æœç´¢"2024-01"åº”æ‰¾åˆ°2ä¸ªåŒ¹é…',
                       `å®é™…: ${info29.total} (2024-01-16, 2024-01-17)`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•30ï¼šåå‘æœç´¢ï¼ˆå…ˆé•¿åçŸ­ï¼‰
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•30ï¼šåå‘æœç´¢ï¼ˆå…ˆé•¿åçŸ­ï¼‰</div></div>', 'info');
                
                const testData30 = {
                    version: '1.0',
                    items: ['abc123xyz'],
                    categories: []
                };
                
                loadTestData(testData30);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = 'abc123xyz';
                handleSearch('abc123xyz');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info30a = getHighlightInfo();
                assert(info30a.total === 1,
                       'æœç´¢å®Œæ•´å­—ç¬¦ä¸²åº”æ‰¾åˆ°1ä¸ªåŒ¹é…',
                       `å®é™…: ${info30a.total}`);
                
                searchInput.value = 'abc';
                handleSearch('abc');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info30b = getHighlightInfo();
                assert(info30b.total === 1,
                       'åå‘æœç´¢çŸ­å­—ç¬¦ä¸²åº”æ‰¾åˆ°1ä¸ªåŒ¹é…',
                       `å®é™…: ${info30b.total}`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•31ï¼šæ­£åˆ™è¡¨è¾¾å¼ç‰¹æ®Šå­—ç¬¦
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•31ï¼šæ­£åˆ™è¡¨è¾¾å¼ç‰¹æ®Šå­—ç¬¦</div></div>', 'info');
                
                const testData31 = {
                    version: '1.0',
                    items: ['a.b', 'a*b', 'a+b'],
                    categories: []
                };
                
                loadTestData(testData31);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = '.';
                handleSearch('.');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info31 = getHighlightInfo();
                assert(info31.total === 1,
                       'æ­£åˆ™è¡¨è¾¾å¼ç‰¹æ®Šå­—ç¬¦æœç´¢"."åº”æ‰¾åˆ°1ä¸ªåŒ¹é…',
                       `å®é™…: ${info31.total} (æŒ‰å­—é¢æœç´¢ï¼Œä¸æ˜¯æ­£åˆ™)`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•32ï¼šè·¯å¾„åˆ†éš”ç¬¦
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•32ï¼šè·¯å¾„åˆ†éš”ç¬¦</div></div>', 'info');
                
                const testData32 = {
                    version: '1.0',
                    items: ['/home/user/file', 'C:\\Users\\file', 'home/user/file'],
                    categories: []
                };
                
                loadTestData(testData32);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = '/';
                handleSearch('/');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info32 = getHighlightInfo();
                assert(info32.total === 5,
                       'è·¯å¾„åˆ†éš”ç¬¦æœç´¢"/"åº”æ‰¾åˆ°5ä¸ªåŒ¹é…',
                       `å®é™…: ${info32.total} (/home/user/fileæœ‰3ä¸ª, home/user/fileæœ‰2ä¸ª)`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•33ï¼šç²¾ç¡®åŒ¹é…æ•´ä¸ªæ¡ç›®
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•33ï¼šç²¾ç¡®åŒ¹é…æ•´ä¸ªæ¡ç›®</div></div>', 'info');
                
                const testData33 = {
                    version: '1.0',
                    items: ['test', 'testing', 'atestb'],
                    categories: []
                };
                
                loadTestData(testData33);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = 'test';
                handleSearch('test');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info33 = getHighlightInfo();
                assert(info33.total === 3,
                       'ç²¾ç¡®åŒ¹é…æ•´ä¸ªæ¡ç›®"test"åº”æ‰¾åˆ°3ä¸ªåŒ¹é…',
                       `å®é™…: ${info33.total} (test, teståœ¨testingä¸­, teståœ¨atestbä¸­)`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•34ï¼šå¿«é€Ÿè¿ç»­æœç´¢
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•34ï¼šå¿«é€Ÿè¿ç»­æœç´¢</div></div>', 'info');
                
                const testData34 = {
                    version: '1.0',
                    items: ['abc123'],
                    categories: []
                };
                
                loadTestData(testData34);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = 'a';
                handleSearch('a');
                await new Promise(resolve => setTimeout(resolve, 50));
                
                searchInput.value = 'ab';
                handleSearch('ab');
                await new Promise(resolve => setTimeout(resolve, 50));
                
                searchInput.value = 'abc';
                handleSearch('abc');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info34 = getHighlightInfo();
                assert(info34.total === 1,
                       'å¿«é€Ÿè¿ç»­æœç´¢åº”æ­£ç¡®å¤„ç†',
                       `å®é™…: ${info34.total}`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•35ï¼šæ•°å­¦ç¬¦å·
                log('<div class="test-section"><div class="test-section-title">æµ‹è¯•35ï¼šæ•°å­¦ç¬¦å·</div></div>', 'info');
                
                const testData35 = {
                    version: '1.0',
                    items: ['1+1=2', '2Ã—3=6', '10Ã·2=5'],
                    categories: []
                };
                
                loadTestData(testData35);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                searchInput.value = '=';
                handleSearch('=');
                await new Promise(resolve => setTimeout(resolve, 300));
                
                const info35 = getHighlightInfo();
                assert(info35.total === 3,
                       'æ•°å­¦ç¬¦å·æœç´¢"="åº”æ‰¾åˆ°3ä¸ªåŒ¹é…',
                       `å®é™…: ${info35.total}`);
                
                clearSearch();
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // æµ‹è¯•æ€»ç»“
                log('\n' + '='.repeat(50), 'info');
                log('ğŸ“Š æµ‹è¯•æ€»ç»“', 'info');
                log('='.repeat(50), 'info');
                log(`æ€»æµ‹è¯•æ•°: ${totalTests}`, 'info');
                log(`é€šè¿‡: ${passedTests} âœ“`, 'success');
                log(`å¤±è´¥: ${failedTests} âœ—`, failedTests > 0 ? 'error' : 'success');
                log(`é€šè¿‡ç‡: ${totalTests > 0 ? ((passedTests / totalTests) * 100).toFixed(2) : 0}%`, 'info');
                
                if (failedTests === 0) {
                    log('\nğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼', 'success');
                } else {
                    log('\nâš ï¸ éƒ¨åˆ†æµ‹è¯•å¤±è´¥ï¼Œè¯·æ£€æŸ¥è¯¦ç»†ä¿¡æ¯', 'error');
                }
                
            } catch (error) {
                log(`âŒ æµ‹è¯•å‡ºé”™: ${error.message}`, 'error');
                console.error(error);
            }
        }

        function resetTest() {
            document.getElementById('testResults').innerHTML = '';
            totalTests = 0;
            passedTests = 0;
            failedTests = 0;
            testResults = [];
            updateProgress();
            log('ğŸ”„ æµ‹è¯•å·²é‡ç½®', 'info');
        }

        // é¡µé¢åŠ è½½æç¤º
        window.addEventListener('load', () => {
            log('ğŸ“‹ ç‚¹å‡»"è¿è¡Œå…¨éƒ¨æµ‹è¯•"æŒ‰é’®å¼€å§‹è‡ªåŠ¨åŒ–æµ‹è¯•', 'info');
            log('ğŸ’¡ æµ‹è¯•å°†åŒ…æ‹¬ï¼š\n   1-10: åŸºç¡€æœç´¢åŠŸèƒ½\n   11-16: ä¸­æ–‡æœç´¢\n   17-25: é«˜çº§åœºæ™¯\n   26: ç©ºæ ¼æœç´¢\n   27: Unicodeè¡¨æƒ…\n   28: è´§å¸ç¬¦å·\n   29: æ—¥æœŸæ ¼å¼\n   30: åå‘æœç´¢\n   31: æ­£åˆ™ç‰¹æ®Šå­—ç¬¦\n   32: è·¯å¾„åˆ†éš”ç¬¦\n   33: ç²¾ç¡®åŒ¹é…\n   34: å¿«é€Ÿè¿ç»­æœç´¢\n   35: æ•°å­¦ç¬¦å·', 'info');
        });
    </script>
</body>
</html>