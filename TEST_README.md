# Electron 自动化测试说明

本项目使用 Playwright 进行 Electron 应用的自动化测试。

## 安装依赖

```bash
npm install
```

## 运行测试

### 1. 运行所有测试（无头模式）

```bash
npm test
```

### 2. 运行测试（有界面模式）

```bash
npm run test:headed
```

### 3. 使用 Playwright UI 运行测试

```bash
npm run test:ui
```

### 4. 调试模式

```bash
npm run test:debug
```

### 5. 运行需要用户交互的测试

某些测试需要您手动操作系统对话框：

```bash
cd tests
./run-interactive.sh
```

这些测试会：
- 显示提示信息
- 等待您操作（30秒）
- 继续执行后续测试

需要用户交互的测试：
- 测试10: 保存文件（需要选择保存位置）
- 测试11: 打开文件（需要选择文件）
- 测试15: 批量导入（需要选择文件）

## 测试用例

当前包含 15 个自动化测试用例：

1. **新建文件按钮** - 测试新建功能
2. **添加条目** - 测试添加单个条目
3. **添加多个条目** - 测试批量添加条目
4. **创建分类** - 测试创建新分类
5. **拖放条目到分类** - 测试拖拽功能
6. **搜索功能** - 测试搜索高亮
7. **清除搜索** - 测试清除搜索结果
8. **编辑条目** - 测试编辑条目功能
9. **删除条目** - 测试删除条目功能
10. **保存文件** - 测试保存到文件（需要用户交互）
11. **打开文件** - 测试从文件加载（需要用户交互）
12. **撤销操作** - 测试撤销功能
13. **重做操作** - 测试重做功能
14. **搜索导航** - 测试搜索结果导航
15. **批量导入** - 测试批量导入功能（需要用户交互）

## 测试报告

测试完成后，会在 `playwright-report` 目录下生成 HTML 格式的测试报告。

```bash
npx playwright show-report
```

## 注意事项

- 测试会在 `temp` 目录下创建临时文件，测试完成后会自动清理
- 运行测试时请确保没有其他 Electron 实例在运行
- 某些测试可能需要较长时间，请耐心等待
- 需要用户交互的测试会显示提示，请按照提示操作

## 查看测试结果

测试结果会显示在终端中，包括：
- ✓ 通过的测试
- ✗ 失败的测试
- 执行时间
- 错误信息（如果有）

## 故障排除

如果测试失败：
1. 运行 `npm run test:headed` 查看实际执行过程
2. 运行 `npm run test:debug` 进入调试模式
3. 检查 `playwright-report` 目录中的详细报告

## 测试覆盖率

当前测试覆盖了应用的主要功能：
- ✅ 基本操作（添加、编辑、删除）
- ✅ 分类管理
- ✅ 拖拽功能
- ✅ 搜索功能
- ✅ 撤销重做
- ✅ 批量导入
- ⚠️ 文件操作（需要用户交互）